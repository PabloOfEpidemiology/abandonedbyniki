<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abandoned by Niki</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-image: url('fuck.jpg');
            background-repeat: repeat;
            background-size: 50px;
        }
        .container {
            text-align: center;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        input {
            padding: 10px;
            font-size: 16px;
            width: 200px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Abandoned by Niki?</h1>
        <input type="text" id="nameInput" placeholder="Enter your name">
        <button onclick="checkName()">Check</button>
        <div id="result"></div>
    </div>

    <script>
        let abandonedList = [];
        const MAX_SEARCHES = 4;

        function removeDiacritics(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        }

        async function fetchAbandonedList() {
            try {
                const response = await fetch('abandoned.csv');
                const data = await response.text();
                abandonedList = data.split('\n')
                    .map(line => line.split(',').map(item => item.trim()))
                    .filter(line => line[0]);
                console.log('Abandoned list loaded');
            } catch (error) {
                console.error('Error loading abandoned list:', error);
            }
        }

        fetchAbandonedList();

        function getSearchCount() {
            return parseInt(localStorage.getItem('searchCount') || '0');
        }

        function incrementSearchCount() {
            const count = getSearchCount() + 1;
            localStorage.setItem('searchCount', count.toString());
            return count;
        }

        function checkName() {
            const searchCount = incrementSearchCount();
            const result = document.getElementById('result');

            if (searchCount >= MAX_SEARCHES) {
                result.textContent = "Your IP address has reached a search limit. Assume Nikita has abandoned everyone. No one has survived the cleanse. Not even himself. Evil Morty stuff. Probably he has already forgotten about you. Who even is Dylan Elyse etc these names don't ring a bell Should they?!?!?!?!";
                result.style.color = 'red';
                document.getElementById('nameInput').disabled = true;
                document.querySelector('button').disabled = true;
                return;
            }

            const input = removeDiacritics(document.getElementById('nameInput').value.trim().toLowerCase());
            const inputWords = input.split(/\s+/);

            const matchedPerson = abandonedList.find(person => {
                const normalizedPerson = removeDiacritics(person[0].toLowerCase());
                const personWords = normalizedPerson.split(/\s+/);
                if (inputWords.length === 1) {
                    return personWords.includes(input);
                } else {
                    return inputWords.some(word => personWords.includes(word));
                }
            });

            if (matchedPerson) {
                if (matchedPerson[1]) {
                    result.textContent = "You're abandoned for like 3 weeks";
                } else {
                    result.textContent = "You're abandoned";
                }
                result.style.color = 'red';
            } else {
                result.textContent = "You are not abandoned";
                result.style.color = 'green';
            }
        }
    </script>
</body>
</html>
